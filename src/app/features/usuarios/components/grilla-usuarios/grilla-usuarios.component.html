<div class="botonera-flotante">
    <div class="botonera-contenedor">
        <button mat-mini-fab color="accent" matTooltip="Cargar los usuarios" (click)="obtenerUsuarios()">
            <i class="fa-solid fa-arrows-rotate"></i>
        </button>

        <button mat-mini-fab color="primary" matTooltip="Crear un nuevo usuario" (click)="crearUsuario()">
            <i class="fa-solid fa-square-plus"></i>
        </button>

        <mat-slide-toggle color="primary" [(ngModel)]="registrosGrillaActivos" (ngModelChange)="cargarGrilla()"
            matTooltip="Mostrar activos/inactivos">
            <span class="toggle-label">Activos</span>
        </mat-slide-toggle>
    </div>
</div>
<div class="card">
    <div class="font-semibold text-xl mb-4">Usuarios</div>
    <p-table #grillaUsuarios [value]="usuarios" dataKey="Id" [rows]="10" [loading]="cargando" [rowHover]="true"
        [showGridlines]="true" [paginator]="true" [globalFilterFields]="['Usuario', 'Mail']" responsiveLayout="scroll">
        <ng-template #caption>
            <div class="flex justify-between items-center flex-column sm:flex-row">
                <button pButton label="Limpiar filtros" class="p-button-outlined mb-2" icon="pi pi-filter-slash"
                    (click)="limpiarFiltrado(grillaUsuarios)"></button>
                <p-iconfield iconPosition="left" class="ml-auto">
                    <p-inputicon>
                        <i class="pi pi-search"></i>
                    </p-inputicon>
                    <input #filter class="w-50vw" pInputText type="text"
                        (input)="filtrarUsuarios(grillaUsuarios, $event)" placeholder="Buscar" />
                </p-iconfield>
            </div>
        </ng-template>
        <ng-template #header>
            <tr>
                <th style="min-width: 12rem">
                    <div class="flex justify-between items-center">
                        Usuario
                        <p-columnFilter type="text" field="Usuario" display="menu"
                            placeholder="Buscar por usuario"></p-columnFilter>
                    </div>
                </th>
                <th style="min-width: 14rem">
                    <div class="flex justify-between items-center">
                        Mail
                        <p-columnFilter type="text" field="Mail" display="menu"
                            placeholder="Buscar por mail"></p-columnFilter>
                    </div>
                </th>
                <th style="min-width: 10rem">
                    <div class="flex justify-between items-center">
                        Ultima Conexion
                        <p-columnFilter type="date" field="UltimaConexion" display="menu"
                            placeholder="mm/dd/yyyy"></p-columnFilter>
                    </div>
                </th>
            </tr>
        </ng-template>
        @if(!cargando){
        <ng-template #body let-usuario>
            <tr (click)="editarUsuario(usuario.Id)" class="cursor-pointer">
                <td>
                    {{ usuario.Usuario }}
                </td>
                <td>
                    {{usuario.Mail}}
                </td>
                <td>
                    {{usuario.UltimaConexion | date: 'dd/mm/yyyy'}}
                </td>
            </tr>
        </ng-template>
        }
        <ng-template #emptymessage>
            <tr>
                <td colspan="8">No se encontraron usuarios.</td>
            </tr>
        </ng-template>
        <ng-template #loadingbody>
            <tr>
                <td colspan="8">Cargando usuarios</td>
            </tr>
        </ng-template>
    </p-table>
</div>